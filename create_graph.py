example = "micro_avg: 0.000, macro_avg: 0.000, glue-diagnostic_lex_sem: 0.348, glue-diagnostic_lex_sem__Lexical entailment: 0.270, glue-diagnostic_lex_sem__Redundancy: 0.677, glue-diagnostic_lex_sem__Quantifiers: 0.572, glue-diagnostic_lex_sem__Symmetry/Collectivity: 0.000, glue-diagnostic_lex_sem__Factivity: 0.122, glue-diagnostic_lex_sem__Morphological negation: 0.436, glue-diagnostic_lex_sem__Factivity;Quantifiers: 0.000, glue-diagnostic_lex_sem__Lexical entailment;Factivity: 0.000, glue-diagnostic_lex_sem__Named entities: 0.183, glue-diagnostic_lex_sem__Lexical entailment;Quantifiers: 1.000, glue-diagnostic_pr_ar_str: 0.395, glue-diagnostic_pr_ar_str__Intersectivity: 0.298, glue-diagnostic_pr_ar_str__Nominalization;Genitives/Partitives: 0.000, glue-diagnostic_pr_ar_str__Ellipsis/Implicits;Anaphora/Coreference: -0.577, glue-diagnostic_pr_ar_str__Core args: 0.318, glue-diagnostic_pr_ar_str__Relative clauses: 0.277, glue-diagnostic_pr_ar_str__Genitives/Partitives: 0.685, glue-diagnostic_pr_ar_str__Coordination scope;Prepositional phrases: 0.333, glue-diagnostic_pr_ar_str__Restrictivity;Relative clauses: -1.000, glue-diagnostic_pr_ar_str__Active/Passive;Prepositional phrases: 1.000, glue-diagnostic_pr_ar_str__Intersectivity;Ellipsis/Implicits: 0.000, glue-diagnostic_pr_ar_str__Datives: 0.673, glue-diagnostic_pr_ar_str__Prepositional phrases: 0.647, glue-diagnostic_pr_ar_str__Core args;Anaphora/Coreference: 0.447, glue-diagnostic_pr_ar_str__Relative clauses;Anaphora/Coreference: 1.000, glue-diagnostic_pr_ar_str__Relative clauses;Restrictivity: 0.577, glue-diagnostic_pr_ar_str__Ellipsis/Implicits: 0.317, glue-diagnostic_pr_ar_str__Coordination scope: 0.402, glue-diagnostic_pr_ar_str__Anaphora/Coreference: 0.270, glue-diagnostic_pr_ar_str__Restrictivity;Anaphora/Coreference: 0.000, glue-diagnostic_pr_ar_str__Anaphora/Coreference;Prepositional phrases: 1.000, glue-diagnostic_pr_ar_str__Nominalization: 0.367, glue-diagnostic_pr_ar_str__Active/Passive: 0.445, glue-diagnostic_pr_ar_str__Restrictivity: -0.250, glue-diagnostic_logic: 0.191, glue-diagnostic_logic__Conditionals: 0.247, glue-diagnostic_logic__Universal;Conjunction: 0.000, glue-diagnostic_logic__Downward monotone;Conditionals: -1.000, glue-diagnostic_logic__Intervals/Numbers: -0.170, glue-diagnostic_logic__Existential: 0.400, glue-diagnostic_logic__Upward monotone: 0.349, glue-diagnostic_logic__Disjunction;Conjunction: 0.000, glue-diagnostic_logic__Conjunction;Upward monotone: 1.000, glue-diagnostic_logic__Double negation;Negation: 0.000, glue-diagnostic_logic__Existential;Upward monotone: 1.000, glue-diagnostic_logic__Temporal: 0.025, glue-diagnostic_logic__Non-monotone: 0.127, glue-diagnostic_logic__Conjunction;Negation: 0.250, glue-diagnostic_logic__Downward monotone: -0.392, glue-diagnostic_logic__Temporal;Intervals/Numbers: 0.000, glue-diagnostic_logic__Universal;Negation: 0.000, glue-diagnostic_logic__Disjunction;Negation: -0.316, glue-diagnostic_logic__Universal: 0.682, glue-diagnostic_logic__Conjunction: 0.483, glue-diagnostic_logic__Disjunction: -0.374, glue-diagnostic_logic__Disjunction;Conditionals;Negation: 0.167, glue-diagnostic_logic__Existential;Negation: 0.000, glue-diagnostic_logic__Negation;Conditionals: 0.000, glue-diagnostic_logic__Temporal;Conjunction: 0.000, glue-diagnostic_logic__Double negation: 0.257, glue-diagnostic_logic__Negation: -0.008, glue-diagnostic_logic__Downward monotone;Existential;Negation: -1.000, glue-diagnostic_logic__Intervals/Numbers;Non-monotone: 1.000, glue-diagnostic_logic__Disjunction;Non-monotone: 0.000, glue-diagnostic_knowledge: 0.198, glue-diagnostic_knowledge__World knowledge: 0.158, glue-diagnostic_knowledge__Common sense: 0.234, glue-diagnostic_all_mcc: 0.312, glue-diagnostic_accuracy: 0.557"
example2 = "micro_avg: -1.2, macro_avg: 0.000, glue-diagnostic_lex_sem: 0.348, glue-diagnostic_lex_sem__Lexical entailment: 0.270, glue-diagnostic_lex_sem__Redundancy: 0.677, glue-diagnostic_lex_sem__Quantifiers: 0.572, glue-diagnostic_lex_sem__Symmetry/Collectivity: 0.000, glue-diagnostic_lex_sem__Factivity: 0.122, glue-diagnostic_lex_sem__Morphological negation: 0.436, glue-diagnostic_lex_sem__Factivity;Quantifiers: 0.000, glue-diagnostic_lex_sem__Lexical entailment;Factivity: 0.000, glue-diagnostic_lex_sem__Named entities: 0.183, glue-diagnostic_lex_sem__Lexical entailment;Quantifiers: 1.000, glue-diagnostic_pr_ar_str: 0.395, glue-diagnostic_pr_ar_str__Intersectivity: 0.298, glue-diagnostic_pr_ar_str__Nominalization;Genitives/Partitives: 0.000, glue-diagnostic_pr_ar_str__Ellipsis/Implicits;Anaphora/Coreference: -0.577, glue-diagnostic_pr_ar_str__Core args: 0.318, glue-diagnostic_pr_ar_str__Relative clauses: 0.277, glue-diagnostic_pr_ar_str__Genitives/Partitives: 0.685, glue-diagnostic_pr_ar_str__Coordination scope;Prepositional phrases: 0.333, glue-diagnostic_pr_ar_str__Restrictivity;Relative clauses: -1.000, glue-diagnostic_pr_ar_str__Active/Passive;Prepositional phrases: 1.000, glue-diagnostic_pr_ar_str__Intersectivity;Ellipsis/Implicits: 0.000, glue-diagnostic_pr_ar_str__Datives: 0.673, glue-diagnostic_pr_ar_str__Prepositional phrases: 0.647, glue-diagnostic_pr_ar_str__Core args;Anaphora/Coreference: 0.447, glue-diagnostic_pr_ar_str__Relative clauses;Anaphora/Coreference: 1.000, glue-diagnostic_pr_ar_str__Relative clauses;Restrictivity: 0.577, glue-diagnostic_pr_ar_str__Ellipsis/Implicits: 0.317, glue-diagnostic_pr_ar_str__Coordination scope: 0.402, glue-diagnostic_pr_ar_str__Anaphora/Coreference: 0.270, glue-diagnostic_pr_ar_str__Restrictivity;Anaphora/Coreference: 0.000, glue-diagnostic_pr_ar_str__Anaphora/Coreference;Prepositional phrases: 1.000, glue-diagnostic_pr_ar_str__Nominalization: 0.367, glue-diagnostic_pr_ar_str__Active/Passive: 0.445, glue-diagnostic_pr_ar_str__Restrictivity: -0.250, glue-diagnostic_logic: 0.191, glue-diagnostic_logic__Conditionals: 0.247, glue-diagnostic_logic__Universal;Conjunction: 0.000, glue-diagnostic_logic__Downward monotone;Conditionals: -1.000, glue-diagnostic_logic__Intervals/Numbers: -0.170, glue-diagnostic_logic__Existential: 0.400, glue-diagnostic_logic__Upward monotone: 0.349, glue-diagnostic_logic__Disjunction;Conjunction: 0.000, glue-diagnostic_logic__Conjunction;Upward monotone: 1.000, glue-diagnostic_logic__Double negation;Negation: 0.000, glue-diagnostic_logic__Existential;Upward monotone: 1.000, glue-diagnostic_logic__Temporal: 0.025, glue-diagnostic_logic__Non-monotone: 0.127, glue-diagnostic_logic__Conjunction;Negation: 0.250, glue-diagnostic_logic__Downward monotone: -0.392, glue-diagnostic_logic__Temporal;Intervals/Numbers: 0.000, glue-diagnostic_logic__Universal;Negation: 0.000, glue-diagnostic_logic__Disjunction;Negation: -0.316, glue-diagnostic_logic__Universal: 0.682, glue-diagnostic_logic__Conjunction: 0.483, glue-diagnostic_logic__Disjunction: -0.374, glue-diagnostic_logic__Disjunction;Conditionals;Negation: 0.167, glue-diagnostic_logic__Existential;Negation: 0.000, glue-diagnostic_logic__Negation;Conditionals: 0.000, glue-diagnostic_logic__Temporal;Conjunction: 0.000, glue-diagnostic_logic__Double negation: 0.257, glue-diagnostic_logic__Negation: -0.008, glue-diagnostic_logic__Downward monotone;Existential;Negation: -1.000, glue-diagnostic_logic__Intervals/Numbers;Non-monotone: 1.000, glue-diagnostic_logic__Disjunction;Non-monotone: 0.000, glue-diagnostic_knowledge: 0.198, glue-diagnostic_knowledge__World knowledge: 0.158, glue-diagnostic_knowledge__Common sense: 0.234, glue-diagnostic_all_mcc: 0.312, glue-diagnostic_accuracy: 0.557"

import matplotlib.pyplot as plt; plt.rcdefaults()
import numpy as np
import matplotlib.pyplot as plt
"""
x = range(7)
negative_data = [-1,-4,-3,-2,-6,-2,-8]
positive_data = [4,2,3,1,4,6,7,]

fig = plt.figure()
ax = plt.subplot(111)
ax.bar(x, negative_data, width=1, color='r')
ax.bar(x, positive_data, width=1, color='b')
"""
def create_graph(diff1, diff2, task):
        """
        diff1 is only mnli, difff2 isthe template iwth the intermediate trianing.

        """
        units1 = diff1.split(",")
        diff1 = {x.split(":")[0]: float(x.split(":")[1]) for x in units1}
        units2 = diff2.split(",")
        diff2 = {x.split(":")[0]: float(x.split(":")[1]) for x in units2}
        # and then take the minus of after
        changes = {x: diff2[x] -diff1[x] for x in diff1.keys()}
        x = range(36)
        from matplotlib.pyplot import figure

        figure(num=None, figsize=(10, 10), dpi=80, facecolor='w', edgecolor='k')
        plt.bar(x, list(changes.values())[:36], align='center', alpha=0.5)
        plt.xticks(x, list(diff1.keys())[:36])
        plt.ylabel('Linguistic phneomena')
        plt.title('Effect of intermediate task training on %s on diagnostic tasks part 1' % task)
        plt.xticks(rotation=90)
        plt.tight_layout()

        plt.show()
        figure(num=None, figsize=(10, 10), dpi=80, facecolor='w', edgecolor='k')
        plt.bar(x, list(changes.values())[36:], align='center', alpha=0.5)
        plt.xticks(x, list(diff1.keys())[36:])
        plt.ylabel('Linguistic phneomena')
        plt.title('Effect of intermediate task training on %s on diagnostic tasks part 2' % task)
        plt.xticks(rotation=90)
        plt.tight_layout()
        plt.show()
def render_graph(path1, path2, task):
    log1 = open(path1, "rb").readlines()
    log2 = open(path2, "rb").readlines()
    log1 = [x.decode("utf-8") for x in log1]
    log1 = " ".join(log1)
    log2 = [x.decode("utf-8") for x in log2]
    log2 = " ".join(log2)
    diff1 = log1.split("Writing results for split 'val' to ")
    for segment in diff1[::-1]:
        if "glue" in segment:
             current_segment1 = segment
             break
    diff2 = log2.split("Writing results for split 'val' to ")
    import pdb; pdb.set_trace()
    for segment in diff2[::-1]:
        if "glue" in segment:
             current_segment2 = segment
             break
    current_segment1_segs = current_segment1.split("glue-diagnostic_accuracy")
    current_segment1 = current_segment1_segs[0] + "glue-diagnostic_accuracy"
    current_segment1 += current_segment1_segs[1].split("\n")[0] # get the vlaue for glue-diagnostic_accuracy
    current_segment2_segs = current_segment2.split("glue-diagnostic_accuracy")
    current_segment2 = current_segment2_segs[0] + "glue-diagnostic_accuracy"
    current_segment2 += current_segment2_segs[1].split("\n")[0] # get the vlaue for glue-diagnostic_accuracy
    import pdb; pdb.set_trace()
    current_segment1 = "micro_avg:"+current_segment1.split("micro_avg:")[1]
    current_segment2 = "micro_avg:"+current_segment2.split("micro_avg:")[1]
    create_graph(current_segment1, current_segment2, task)
dir = "/Users/yadapruksachatkun/jiant_again/"
render_graph(dir + "mnli_onlly_log",dir + "mnli_wnli_log", "COPA")                                                       
